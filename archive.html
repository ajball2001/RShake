<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Links</title>
    <style>
        /* CSS to style the columns */
        #imageLinks {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
    </style>
</head>
<body>
    <h1>Image Links</h1>
    <div id="imageLinks">
        <!-- Image links will be added here dynamically -->
    </div>
    <button onclick="goToGallery()">Go back to Image Gallery</button>

    <script>
        function goToGallery() {
            window.location.href = 'index.html'; 
        }

        function populateImageLinks() {
            fetch('https://rshakeimages.blob.core.windows.net/rshakeimagescontainer?restype=container&comp=list')
                .then(response => response.text())
                .then(text => {
                    var parser = new DOMParser();
                    var xml = parser.parseFromString(text, 'application/xml');
                    var blobs = xml.getElementsByTagName('Blob');
                    var imageLinks = document.getElementById('imageLinks');
                    for (var i = 0; i < blobs.length; i++) {
                        var nameElement = blobs[i].getElementsByTagName('Name')[0];
                        if (nameElement) {
                            var fileName = nameElement.textContent;
                            var dateTimeStr = fileName.split('-').slice(1).join('-').split('.')[0]; // Remove file extension
                            var year = dateTimeStr.substring(0, 4);
                            var month = dateTimeStr.substring(5, 7);
                            var day = dateTimeStr.substring(8, 10);
                            var hour = dateTimeStr.substring(11, 13);
                            var minute = dateTimeStr.substring(13, 15);
                            var second = dateTimeStr.substring(15, 17);

                            // Convert UTC to CST (Central Standard Time) by subtracting 6 hours
                            var cstHour = parseInt(hour) - 6;
                            if (cstHour < 0) {
                                // Adjust for previous day if the hour is negative
                                var utcDate = new Date(Date.UTC(year, month - 1, day, hour, minute, second));
                                utcDate.setDate(utcDate.getDate() - 1); // Subtract one day
                                year = utcDate.getUTCFullYear();
                                month = (utcDate.getUTCMonth() + 1).toString().padStart(2, '0'); // Month is zero-based
                                day = utcDate.getUTCDate().toString().padStart(2, '0');
                                cstHour = (utcDate.getUTCHours() + 24 - 6) % 24; // Adjust for 24-hour format
                            }

                            // Adjust AM/PM indicator based on 12-hour format
                            var ampm = (cstHour >= 12) ? 'PM' : 'AM';
                            cstHour = (cstHour % 12) || 12;

                            var dateLabel = 'Date: ' + month + '/' + day + '/' + year + ', Time: ' + cstHour + ':' + minute + ':' + second + ' ' + ampm;
                            var url = 'https://rshakeimages.blob.core.windows.net/rshakeimagescontainer/' + fileName;
                            var listItem = document.createElement('div');
                            var link = document.createElement('a');
                            link.textContent = dateLabel;
                            link.href = url;
                            link.target = '_blank'; // Open link in a new tab
                            listItem.appendChild(link);
                            imageLinks.appendChild(listItem);
                        } else {
                            console.error('Missing expected elements in XML response:', blobs[i]);
                        }
                    }
                })
                .catch(error => console.error('Error fetching images:', error));
        }

        populateImageLinks();
    </script>
</body>
</html>
